

<!DOCTYPE html>

<html>
<head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <!-- for 360 分别代表用极速模式，兼容模式，IE模式打开-->
    <meta name="renderer" content="webkit|ie-comp|ie-stand" />
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,member-scalable=no" />
    <meta http-equiv="Cache-Control" content="no-siteapp" />
    <link href="../Content/css/H-ui.min.css" rel="stylesheet" type="text/css" />
    <link href="../Content/css/H-ui.admin.css" rel="stylesheet" type="text/css" />
    <link href="../lib/Hui-iconfont/1.0.1/iconfont.css" rel="stylesheet" type="text/css" />
    <link href="../lib/icheck/skins/all.css" rel="stylesheet" />
</head>
<body>
    <div class="pd-10">
        <form action="../User/UserChangeSensorEdit" autocomplete="off" method="post" class="form form-horizontal" id="form-member-edit">
        	<div class="row cl">                
                <div class="formControls col-5">                    
                     <input type="hidden" id="sensorNum0" name="sensorNum0" />
                </div>
            </div>
            <div class="row cl">                
                <div class="formControls col-5">                    
                     <input type="hidden" id="sensorUnit0" name="sensorUnit0" />
                </div>
            </div>
            <div class="row cl">
                <label class="form-label col-3"><span class="c-red">*</span>请选择终端：</label>
                <div class="formControls col-5">
                    <select id="terminalNum" name="terminalNum" class="input-text">                                                                                             
                     </select>
				</div>
                <div class="col-4"></div>
            </div>
            <div class="row cl">
                <label class="form-label col-3"><span class="c-red">*</span>传感器编号(15位)：</label>
                <div class="formControls col-5">                    
                     <input type="text" class="input-text" id="sensorNum" name="sensorNum" datatype="*15-15" nullmsg="传感器编号不能为空"/>
                </div>
                <div class="col-4"></div>
            </div>
            <div class="row cl">
                <label class="form-label col-3">灾害点名称：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="stationName" name="stationName" />
                </div>
                <div class="col-4"></div>
            </div>
            <div class="row cl">
                <label class="form-label col-3">监测点名称：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="terminalName" name="terminalName" />
                </div>
                <div class="col-4"></div>
            </div>
            <div class="row cl">
                <label class="form-label col-3">仪器名称：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="sensorName" name="sensorName" />
                </div>
                <div class="col-4"></div>
            </div>    
            <div class="row cl">
                <label class="form-label col-3">仪器类型：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="sensorType" name="sensorType" />
                </div>
                <div class="col-4"></div>
            </div> 
            <div class="row cl">
                <label class="form-label col-3">监测单位：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="sensorUnit" name="sensorUnit" />
                </div>
                <div class="col-4"></div>
            </div> 
            <div class="row cl">
                <label class="form-label col-3">精度：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="sensorAccurate" name="sensorAccurate" />
                </div>
                <div class="col-4"></div>
            </div> 
            <div class="row cl">
                <label class="form-label col-3">经度：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="longitude" name="longitude" />
                </div>
                <div class="col-4"></div>
            </div> 
            <div class="row cl">
                <label class="form-label col-3">纬度：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="latitude" name="latitude" />
                </div>
                <div class="col-4"></div>
            </div> 
            <div class="row cl">
                <label class="form-label col-3">上限值：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="upperLimits" name="upperLimits" datatype="*1-100" nullmsg="上限值不能为空"/>
                </div>
                <div class="col-4">若无上限值，请填写null</div>
            </div> 
            <div class="row cl">
                <label class="form-label col-3">下限值：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="lowerLimits" name="lowerLimits" datatype="*1-100" nullmsg="下限值不能为空"/>
                </div>
                <div class="col-4">若无下限值，请填写null</div>
            </div> 
            <div class="row cl">
                <label class="form-label col-3"><span class="c-red">*</span>资源导航标签：</label>
                <div class="formControls col-5">
                    <input type="text" class="input-text" id="treenum" name="treenum" datatype="*" nullmsg="资源导航不能为空" />
                </div>
                <div class="col-4"></div>
            </div>                                  
            <div class="row cl">
                <div class="col-3-2 col-offset-4">
                    <input class="btn btn-primary radius" type="submit"  id="SaveButton" name="SaveButton" value="&nbsp;&nbsp;&nbsp;保存&nbsp;&nbsp;&nbsp;" />
               		&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
               		<input class="btn btn-primary radius" type="button" id="CancelButton" class="CancelButton" value="&nbsp;&nbsp;取消&nbsp;&nbsp;">              		              
                </div>
              
            </div>
        </form>
    </div>

    <script src="../Scripts/jquery-1.11.3.min.js"></script>
   <script src="../lib/icheck/icheck.min.js"></script>

    <script type="text/javascript" src="../lib/Validform/5.3.2/Validform.min.js"></script>

    <script type="text/javascript" src="../lib/layer/1.9.3/layer.js"></script>
    <script type="text/javascript" src="../lib/H-ui.js"></script>
    <script type="text/javascript" src="../lib/H-ui.admin.js"></script>

    <script type="text/javascript">
    	var TerminalList = null;
    	var terminalNum = null;
        $(function () {
        	var url=window.location.href.split("?")[1];
        	var sensorNum = url.split("=")[1];
        	$.ajax({
                type: 'GET',
                url: '../User/GetAddUserSensorTerminalList',
                async: false,
                cache: false,
                success: function (result) {
                	var result= eval("(" + result + ")"); 
                	TerminalList = result;                   
                }
            });
        	$.ajax({
                type: 'GET',
                url: '../User/GetUserSensorChange',
                async: false,
                cache: false,
                data: { sensorNum : sensorNum },
                success: function (result) {
                	var result= eval("(" + result + ")"); 
                	$("#sensorNum0").val(result['sensorNum']);
                    $("#sensorNum").val(result['sensorNum']);          
                    $("#stationName").val(result['stationName']);
                    $("#terminalName").val(result['terminalName']);          
                    $("#sensorName").val(result['sensorLocation']); 
                    $("#sensorType").val(result['sensorType']);
                    $("#sensorUnit").val(result['sensorUnit']);          
                    $("#sensorAccurate").val(result['sensorAccurate']); 
                    $("#upperLimits").val(result['upperLimits']);
                    $("#lowerLimits").val(result['lowerLimits']); 
                    $("#longitude").val(result['longitude']);
                    $("#latitude").val(result['latitude']);
                    $("#sensorUnit0").val(result['sensorUnit']); 
                    $("#treenum").val(result['treenum']);
                    terminalNum = result['terminalNum']; 
                    
                }
            });
        	
            $('input').iCheck({
                checkboxClass: 'icheckbox_square-blue',
                radioClass: 'iradio_square-blue',
                increaseArea: '20%'
            });
            //验证表单
            $("#form-member-edit").Validform({
                tiptype: 1,
                ajaxPost: true,
                callback: function (data) {
                    if (data.success) {                   	
                        layer.open({ 
                        	content:'修改用户传感器信息成功!若您修改了单位数量，记得修改预警值！',
                        	icon: 1, 
                        	time: 5000,
                        	end:function(){
                        		var index = parent.layer.getFrameIndex(window.name);
                                //parent.$('.btn-success').click();
                                parent.$('#list_data').datagrid('reload');
                                parent.layer.close(index);
                        	}});
                        
                    } else {
                        layer.msg('修改失败,请检查录入项是否规范!', { icon: 1, time: 1000, 
                        	end:function(){
                        		var index = parent.layer.getFrameIndex(window.name);
                                //parent.$('.btn-success').click();
                                parent.$('#list_data').datagrid('reload');
                                parent.layer.show(index);
                        	} });
                    }

                }
            
            });
            
            $("#CancelButton").click(function(){
            	var index = parent.layer.getFrameIndex(window.name);
                //parent.$('.btn-success').click();
                parent.$('#list_data').datagrid('reload');
                parent.layer.close(index);
            });                        

        });
        function load_conditions(){   	 
    		for(var i = 0;i < TerminalList.terminalList.length; i ++){    		
    			//console.log(TerminalList.terminalList[i]);
    			$("#terminalNum").append('<option value="'+TerminalList.terminalList[i]+'">'+TerminalList.terminalList[i]+'</option>');
    		}
    		$("#terminalNum").val(terminalNum);
    	}
    	window.onload = function(){
    		load_conditions();
    	}
    </script>

</body>
</html>
